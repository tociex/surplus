@model materialsurplus.Models.Materialsurplus

@{
    ViewData["Title"] = "Details";
}
<script type="text/javascript" src="~/css/jquery.min.js"></script>
<script type="text/javascript" src="~/css/qrcode.js"></script>

<div>
    <h4 class="noPrint">Material Surplus</h4>
    <hr />
    <dl class="row">
        <div class="col-md-12">
             <div class="col-md-6 noPrint">
                    <dt class = "col-sm-6">
                        @Html.DisplayNameFor(model => model.Tgl_input)
                    </dt>
                    <dd class = "col-sm-6">
                        @Html.DisplayFor(model => model.Tgl_input)
                    </dd>
                    <dt class = "col-sm-6">
                        @Html.DisplayNameFor(model => model.Source_material)
                    </dt>
                    <dd class = "col-sm-6">
                        @Html.DisplayFor(model => model.Source_material)
                    </dd>
                    <dt class = "col-sm-6">
                        @Html.DisplayNameFor(model => model.Material_no)
                    </dt>
                    <dd class = "col-sm-6">
                        @Html.DisplayFor(model => model.Material_no)
                    </dd>
                    <dt class = "col-sm-6">
                        @Html.DisplayNameFor(model => model.Old_material)
                    </dt>
                    <dd class = "col-sm-6">
                        @Html.DisplayFor(model => model.Old_material)
                    </dd>
                    <dt class = "col-sm-6">
                        @Html.DisplayNameFor(model => model.Short_desc)
                    </dt>
                    <dd class = "col-sm-6">
                        @Html.DisplayFor(model => model.Short_desc)
                    </dd>
                    <dt class = "col-sm-6">
                        @Html.DisplayNameFor(model => model.Description)
                    </dt>
                    <dd class = "col-sm-6">
                        @Html.DisplayFor(model => model.Description)
                    </dd>
                    <dt class = "col-sm-6">
                        @Html.DisplayNameFor(model => model.Qty)
                    </dt>
                    <dd class = "col-sm-6">
                        @Html.DisplayFor(model => model.Qty)
                    </dd>
                    <dt class = "col-sm-6">
                        @Html.DisplayNameFor(model => model.Nilai)
                    </dt>
                    <dd class = "col-sm-6">
                        @Html.DisplayFor(model => model.Nilai)
                    </dd>
                    <dt class = "col-sm-6">
                        @Html.DisplayNameFor(model => model.Uom)
                    </dt>
                    <dd class = "col-sm-6">
                        @Html.DisplayFor(model => model.Uom)
                    </dd>

                    <dt class = "col-sm-12 noPrint"> <b>Foto</b> <br/>
                        <!--a href="~/images/@Model.File_foto" target="_blank"><img src="~/images/@Model.File_foto"   
                                        class="rounded-circle"   
                                        height="40" width="40"   
                                        asp-append-version="true" /> </a-->
                        
                        <a onclick="download_image()" href="#" ><canvas id="canvas"   height="600" width="600"  crossorigin="anonymous"></canvas></a>

                   
                    </dt>


                    
            </div>
            <div class="col-md-6">
                    
                    
                    <dt class = "col-sm-6 noPrint">
                        @Html.DisplayNameFor(model => model.Posisi)
                    </dt>
                    <dd class = "col-sm-6 noPrint">
                        @Html.DisplayFor(model => model.Posisi)
                    </dd>
                    <dt class = "col-sm-6 noPrint">
                        @Html.DisplayNameFor(model => model.Luas)
                    </dt>
                    <dd class = "col-sm-6 noPrint">
                        @Html.DisplayFor(model => model.Luas)
                    </dd>
                    <dt class = "col-sm-6 noPrint">
                        @Html.DisplayNameFor(model => model.Sloc)
                    </dt>
                    <dd class = "col-sm-6 noPrint">
                         @Html.DisplayFor(model => model.Sloc)
                    </dd>
                     <dt class = "col-sm-6 noPrint">
                        @Html.DisplayNameFor(model => model.Sbin)
                    </dt>
                    <dd class = "col-sm-6 noPrint">
                        @Html.DisplayFor(model => model.Sbin)
                    </dd>
                   <dd class = "col-sm-6">
                       <b>QrCode</b>
                    </dd>
                  
                     <dd class = "col-sm-6">
                        <input id="text" type="text" value="@Model.Material_no" style="width:80%; display:none" />
                         <div id="qrcode" style="width:100px; height:100px; margin-top:15px;"></div> <br/>
                         <button onclick="window.print();" class="noPrint btn btn-success"><i class="glyphicon glyphicon-print"></i> Print </button>
                    </dd>

                    
                      <dd class = "col-sm-6 onlyPrint">
                        @Html.DisplayFor(model => model.Material_no)
                    </dd>
                    <dd class = "col-sm-6 onlyPrint" >
                        @Html.DisplayFor(model => model.Short_desc)
                    </dd>
                   
                   
                    
                  


            </div>

        </div>
    </dl>
</div>
<div>

     <hr />
    <a asp-action="Index" class="btn btn-danger noPrint" >Back </a>
</div>

<script type="text/javascript">
var qrcode = new QRCode(document.getElementById("qrcode"), {
	width : 100,
	height : 100
});

function makeCode () {		
	var elText = document.getElementById("text");
	
	if (!elText.value) {
		alert("Input a text");
		elText.focus();
		return;
	}
	
	qrcode.makeCode(elText.value);
}

makeCode();

$("#text").
	on("blur", function () {
		makeCode();
	}).
	on("keydown", function (e) {
		if (e.keyCode == 13) {
			makeCode();
		}
	});


var canvas = document.getElementById("canvas");
var ctx = canvas.getContext("2d");
var img = new Image();
img.src = "/images/@Model.File_foto";


img.onload = function () {
   
    // set size proportional to image
    canvas.height = canvas.width * (img.height / img.width);
     img.setAttribute('crossorigin', 'anonymous'); 
     img.crossOrigin = "anonymous"; 
    // step 1 - resize to 50%
    var oc = document.createElement('canvas'),
        octx = oc.getContext('2d');

    oc.width = img.width * 0.7;
    oc.height = img.height * 0.7;
    octx.drawImage(img, 0, 0, oc.width, oc.height);
  
    // step 2
    octx.drawImage(oc, 0, 0, oc.width * 0.7, oc.height * 0.7);

    // step 3, resize to final size
    ctx.drawImage(oc, 0, 0, oc.width * 0.7, oc.height * 0.7,
    0, 0, canvas.width, canvas.height);
   
    // console.log(info);
}


function download_image(){
  
  image = canvas.toDataURL("image/png").replace("image/png", "image/octet-stream");
  var link = document.createElement('a');
  link.download = "my-image.png";
  link.href = image;
  link.click();

}
</script>